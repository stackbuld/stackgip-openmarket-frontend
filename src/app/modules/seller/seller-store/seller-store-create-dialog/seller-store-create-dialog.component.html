<!-- This is the seller-edit modal -->
<div class="edit-store">
  <div mat-dialog-content class="seller-store-modal">
    <button
      class="uk-modal-close-default seller-store-modalCloseBtn"
      type="button"
      uk-close
      [mat-dialog-close]="false"
    ></button>
    <form
      (submit)="onSave()"
      [formGroup]="sellerStoreAddressForm"
      class="uk-form-stacked edit-form uk-form"
    >
      <div class="uk-margin">
        <label class="uk-form-label" for="form-stacked-text">Store Name*</label>
        <div class="uk-form-controls">
          <input
            formControlName="storeName"
            class="uk-input"
            id="form-stacked-text"
            type="text"
            placeholder="Please type your store name"
          />
          <div
            *ngIf="storeName.invalid && (storeName.dirty || storeName.touched)"
          >
            <small
              class="uk-text-danger"
              *ngIf="storeName.hasError('required')"
            >
              Store name is a required field
            </small>
          </div>
        </div>
      </div>
      <div class="uk-margin">
        <label class="uk-form-label" for="form-stacked-text"
          >Store Address*</label
        >
        <div
          *ngIf="mode !== 'edit' || (mode === 'edit' && !notReady)"
          class="uk-form-controls"
        >
          <input
            ngx-google-places-autocomplete
            [options]="options"
            #placesRef="ngx-places"
            (onAddressChange)="handleAddressChange($event)"
            class="uk-input"
            type="text"
            placeholder="Please type your store name"
            formControlName="fullAddress"
          />
          <div
            *ngIf="
              fullAddress.invalid && (fullAddress.dirty || fullAddress.touched)
            "
          >
            <small
              class="uk-text-danger"
              *ngIf="fullAddress.hasError('required')"
            >
              Store address is a required field
            </small>
          </div>
        </div>
        <p
          *ngIf="mode === 'edit' && notReady"
          (click)="setAddressField()"
          class="setter"
        >
          {{ setter }}
        </p>
      </div>
      <div class="uk-grid-small" uk-grid>
        <div class="uk-width-1-2@s">
          <label class="uk-form-label" for="form-stacked-text">City*</label>
          <input
            formControlName="city"
            class="uk-input"
            type="text"
            placeholder="Lagos"
          />
          <div *ngIf="city.invalid && (city.dirty || city.touched)">
            <small class="uk-text-danger" *ngIf="city.hasError('required')">
              city is a required field
            </small>
          </div>
        </div>
        <div class="uk-width-1-2@s">
          <label class="uk-form-label" for="form-stacked-text">State*</label>
          <input
            formControlName="state"
            class="uk-input"
            type="text"
            placeholder="Nigeria"
          />
          <div *ngIf="state.invalid && (state.dirty || state.touched)">
            <small class="uk-text-danger" *ngIf="state.hasError('required')">
              state is a required field
            </small>
          </div>
        </div>
      </div>
      <div class="uk-grid-small" uk-grid>
        <div class="uk-width-1-2@s">
          <label for="">Landmark</label>
          <input
            formControlName="landmark"
            class="uk-input"
            type="text"
            placeholder="Please enter Landmark"
          />
          <div *ngIf="landmark.invalid && (landmark.dirty || landmark.touched)">
            <small class="uk-text-danger" *ngIf="landmark.hasError('required')">
              lanmark nearest to store is a required field
            </small>
          </div>
        </div>

        <div class="uk-width-1-2@s">
          <label for="">Postal Code*</label>
          <input
            formControlName="postalCode"
            class="uk-input"
            type="text"
            placeholder="Please enter postal code"
          />
          <div
            *ngIf="
              postalCode.invalid && (postalCode.dirty || postalCode.touched)
            "
          >
            <small
              class="uk-text-danger"
              *ngIf="postalCode.hasError('required')"
            >
              Store postal code is a required field
            </small>
          </div>
        </div>
      </div>
      <div class="uk-grid-small" uk-grid>
        <div class="uk-width-1-2@s">
          <label for="">Country*</label>
          <input
            formControlName="country"
            class="uk-input"
            type="text"
            placeholder="Nigeria"
          />
          <div *ngIf="country.invalid && (country.dirty || country.touched)">
            <small class="uk-text-danger" *ngIf="country.hasError('required')">
              Country of store address is a required field
            </small>
          </div>
        </div>

        <!-- <div class="uk-width-1-2@s">
          <label for="">Phone Number*</label>
          <input
            type="tel"
            formControlName="contactPhoneNumber"
            class="uk-input"
            type="text"
            placeholder="--- 2348012345678---"
            (keypress)="preventLetter($event)"
          />
          <div
            *ngIf="
              contactPhoneNumber.invalid &&
              (contactPhoneNumber.dirty || contactPhoneNumber.touched)
            "
          >
            <small
              class="uk-text-danger"
              *ngIf="contactPhoneNumber.hasError('required')"
            >
              Contact phone number is a required field
            </small>
          </div>
        </div> -->

        <div class="uk-width-1-2@s">
          <label for="phone">Phone Number*</label>
          <div class="contact-inputs">
            <input
              type="tel"
              placeholder="8023434567"
              formControlName="contactPhoneNumber"
              class="uk-input input-field"
              id="phone"
              (keypress)="preventLetter($event)"
            />

            <div class="country-code" matPrefix>
              <mat-select
                (change)="changeOption($event)"
                formControlName="countryCode"
                class="my-mat-select"
              >
                <mat-select-trigger class="country-code-text">
                  {{ countryCode.value }}
                </mat-select-trigger>
                <mat-option
                  *ngFor="let country of countryInfo"
                  [value]="country.phoneCode"
                >
                  <img [src]="country.flag" alt="" width="25px" height="25px" />
                  <span
                    style="font-size: 14px; margin-left: 7px; font-weight: bold"
                    >{{ country.countryName }}
                  </span>
                  <span style="font-size: 14px">
                    {{ country.phoneCode }}
                  </span>
                </mat-option>
              </mat-select>
            </div>
          </div>
          <div
            *ngIf="
              contactPhoneNumber.invalid &&
              (contactPhoneNumber.dirty || contactPhoneNumber.touched)
            "
          >
            <small
              class="uk-text-danger"
              *ngIf="contactPhoneNumber.hasError('required')"
            >
              Contact phone number is a required field
            </small>
          </div>
          <div
            *ngIf="
              contactPhoneNumber.touched &&
              contactPhoneNumber.invalid &&
              !contactPhoneNumber.hasError('required')
            "
            class="uk-text-danger"
          >
            Enter a valid phone number
          </div>
        </div>
      </div>

      <div class="availability-container" formArrayName="storeAvailabilties">
        <div class="availability-container-heading">Availability</div>
        <div
          class="availability-group"
          *ngFor="let controls of storeAvailability.controls; let i = index"
          [formGroupName]="i"
          [ngClass]="{
            spaceBottom: i + 1 != storeAvailability.controls.length
          }"
        >
          <div class="availability-main">
            <div class="input-group">
              <label [for]="'day' + i">Day</label>
              <select
                class="time-select"
                name=""
                [id]="'day' + i"
                formControlName="dayOfWeek"
              >
                <option [value]="null">Select a day</option>
                <option [value]="day" *ngFor="let day of days">
                  {{ day }}
                </option>
              </select>
            </div>

            <div class="input-group time-group">
              <label [for]="'openingTime' + i">Opening Time</label>

              <!-- <input
                type="text"
                [id]="'openingTime' + i"
                placeholder="select your opening time"
              /> -->

              <ngx-mat-timepicker
                formControlName="openingTime"
                [showSpinners]="true"
                [stepHour]="1"
                [stepMinute]="10"
                [stepSecond]="30"
                [showSeconds]="false"
                class="my-ngx-timepicker"
                [id]="'openingTime' + i"
              >
              </ngx-mat-timepicker>
            </div>

            <div class="input-group time-group">
              <label [for]="'closingTime' + i">Closing Time</label>
              <!-- <input
                type="text"
                [id]="'closingTime' + i"
                placeholder="select your opening time"
                [mat-menu-trigger-for]="closingTimeMenu"
                formControlName="closingTime"
              /> -->
              <ngx-mat-timepicker
                formControlName="closingTime"
                [showSpinners]="true"
                [stepHour]="1"
                [stepMinute]="10"
                [stepSecond]="30"
                [showSeconds]="false"
                [id]="'closingTime' + i"
                class="my-ngx-timepicker"
              >
              </ngx-mat-timepicker>
            </div>
          </div>
          <div class="remove-availability" (click)="onRemoveAvailability(i)">
            <i class="fa fa-times"></i>
          </div>
        </div>
        <button
          id="add-availability"
          (click)="onAddAvailability()"
          type="button"
        >
          Add availability
        </button>
      </div>

      <button class="uk-button uk-button-default uk-modal-close" type="submit">
        <span *ngIf="!loading">
          <span *ngIf="mode !== 'edit'">Save</span>
          <span *ngIf="mode === 'edit'">Update</span>
        </span>
        <span *ngIf="loading">
          <span *ngIf="mode !== 'edit'">saving...</span>
          <span *ngIf="mode === 'edit'">updating...</span>
        </span>
      </button>
    </form>
  </div>
</div>
